"use strict";var __webpack_modules__={146:function(e,t){var r=function(){function e(e){this.jQuery=e}return e.prototype.makeRadio=function(e,t,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var a=document.createElement("input");return a.setAttribute("json",e),a.setAttribute("name",t),a.setAttribute("value",e),a.setAttribute("type","radio"),r&&a.setAttribute("checked","checked"),n&&a.setAttribute("disabled","disabled"),a},e.prototype.makeCheckbox=function(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1);var n=document.createElement("input");return n.setAttribute("json",e),n.setAttribute("name","value"),n.setAttribute("value",e),n.setAttribute("type","checkbox"),t&&n.setAttribute("checked","checked"),r&&n.setAttribute("disabled","disabled"),n},e.prototype.makeHidden=function(e,t,r,n,a,i){var l=document.createElement("input");return l.setAttribute("id",e),l.setAttribute("json",t),l.setAttribute("name",r),l.setAttribute("value",n),l.setAttribute("class",a),l.setAttribute("type","hidden"),l.setAttribute("title",i),l},e.prototype.makeTd=function(e){for(var t=document.createElement("div"),r=0;r<e.length;r++)t.appendChild(e[r]);return t},e.prototype.makeTr=function(e){var t=document.createElement("div");return t.setAttribute("style","white-space:nowrap"),t.setAttribute("class","tr"),e&&t.setAttribute("id",e),t},e.prototype.makeLabel=function(e,t){var r=document.createElement("label");return r.innerHTML=e,r.className="attach-previous",t&&(r.title=t),r},e.prototype.getSelectValues=function(e){return e.val()},e.prototype.getElementValue=function(e){return"SELECT"===e.prop("tagName")?this.getSelectValues(e).toString():"checkbox"===e.attr("type")||"radio"===e.attr("type")?e.prop("checked")?e.val().toString():"":e.val().toString()},e}();t.A=r}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}var __webpack_exports__={};!function(){var e=__webpack_require__(146);function t(){}function r(e,r){if(!r)return e&&e.then?e.then(t):Promise.resolve()}function n(e){var r=e();if(r&&r.then)return r.then(t)}function a(e,t,r){if(!e.s){if(r instanceof i){if(!r.s)return void(r.o=a.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(a.bind(null,e,t),a.bind(null,e,2));e.s=t,e.v=r;const n=e.o;n&&n(e)}}const i=function(){function e(){}return e.prototype.then=function(t,r){const n=new e,i=this.s;if(i){const e=1&i?t:r;if(e){try{a(n,1,e(this.v))}catch(e){a(n,2,e)}return n}return this}return this.o=function(e){try{const i=e.v;1&e.s?a(n,1,t?t(i):i):r?a(n,1,r(i)):a(n,2,i)}catch(e){a(n,2,e)}},n},e}();function l(e,t,r){var n,l,o=-1;return function s(c){try{for(;++o<e.length&&(!r||!r());)if((c=t(o))&&c.then){if(!((u=c)instanceof i&&1&u.s))return void c.then(s,l||(l=a.bind(null,n=new i,2)));c=c.v}n?a(n,1,c):n=c}catch(e){a(n||(n=new i),2,e)}var u}(),n}function o(e){if(e&&e.then)return e.then(t)}function s(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function c(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}jQuery3.noConflict();var u=u||(t=>{const a=c((function(e,t,a,i,l){let o=jQuery(e);if("hidden_uno_choice_parameter"===o.get(0).getAttribute("class")){let e=jQuery(o.get(0)).parents("tbody");e&&0!==e.length||(e=jQuery(o.get(0)).parents("div > div.tr")),e&&e.length>0&&jQuery(e.get(0)).attr("style","visibility:hidden;position:absolute;")}let s=null;for(let e=0;e<o.children().length;e++){let t=o.children()[e];if("value"===t.getAttribute("name")||t.id.indexOf("ecp_")>-1){s=jQuery(t);break}if(t.id.indexOf("inputElement_")>-1){s=jQuery(t);break}if(t.id.indexOf("formattedHtml_")>-1){s=jQuery(t);break}if(t.id.indexOf("imageGallery_")>-1){s=jQuery(t);break}}return n((function(){if(s&&s.get(0)){let e=new u.DynamicReferenceParameter(t,s.get(0),l);u.cascadeParameters.push(e);for(let t=0;t<i.length;++t){let r=null,n=jQuery('div[name="parameter"]');for(let e=0;e<n.length;e++){let a=n[e];if(jQuery(a).find('input[name="name"]')[0].value===i[t]){let e=a.children;for(let t=0;t<e.length;++t){let n=e[t];if("value"===n.getAttribute("name")){r=n;break}if("DIV"===n.tagName||"SPAN"===n.tagName){let e=jQuery(n).find('input[name="value"]');if(e&&e.get(0)){r=n;break}r=n;break}if("file"===n.getAttribute("type")){r=n;break}if("INPUT"===n.tagName&&!["","name"].includes(n.name)){r=n;break}}}}new u.ReferencedParameter(i[t],r,e)}return console.log("Updating cascade of parameter [",t,"] ..."),r(e.update(!1))}console.log("Parameter error: Missing parameter [",a,"] HTML element!")}))})),i=c((function(e,t,a,i,l,o,s,c){let m=jQuery(e),d=m.find("DIV");return d&&0!==d.length||(console.log("Could not find element by name, perhaps it is a DIV?"),d=m.find('*[name="value"]')),n((function(){if(d&&d.get(0)){let e=new u.CascadeParameter(a,d.get(0),i,c);if(u.cascadeParameters.push(e),t){let t=m.find(".uno_choice_filter");if(t&&t.get(0)){let r=new u.FilterElement(d.get(0),t.get(0),l);e.setFilterElement(r)}else console.log("Filter error: Missing filter element!")}for(let t=0;t<s.length;++t){let r=null,n=jQuery('div[name="parameter"]');for(let e=0;e<n.length;e++){let a=n[e];if(jQuery(a).find('input[name="name"]')[0].value===s[t]){let e=a.children;for(let t=0;t<e.length;++t){let n=e[t];if("value"===n.getAttribute("name")){r=n;break}if("DIV"===n.tagName||"SPAN"===n.tagName){let e=jQuery(n).find('input[name="value"]');if(e&&e.get(0)){r=n;break}r=n;break}if("file"===n.getAttribute("type")){r=n;break}if("INPUT"===n.tagName&&!["","name"].includes(n.name)){r=n;break}}}}new u.ReferencedParameter(s[t],r,e)}return console.log("Updating cascade of parameter [",a,"] ..."),r(e.update(!1))}console.log("Parameter error: Missing parameter [",o,"] HTML element!")}))}));let m=new e.A(t),d={},f=[];function g(e,t,r,n){this.paramName=e,this.paramElement=t,this.randomName=r,this.proxy=n,this.referencedParameters=[],this.filterElement=null}function p(e,r,n){this.paramName=e,this.paramElement=r,this.cascadeParameter=n;let a=this;t(this.paramElement).change((e=>{e.parameterName===a.paramName?(console.log("Skipping self reference to avoid infinite loop!"),e.stopImmediatePropagation()):(console.log(`Cascading changes from parameter ${a.paramName}...`),t(".behavior-loading").show(),setTimeout(c((function(){return s(a.cascadeParameter.update(!1),(function(){t(".behavior-loading").hide()}))})),0))})),n.getReferencedParameters().push(this)}function h(e,t,r){this.paramName=e,this.paramElement=t,this.proxy=r,this.referencedParameters=[]}function b(e,r,n){if(this.paramElement=e,this.filterElement=r,this.filterLength=n,this.originalArray=[],"SELECT"===this.paramElement.tagName){let r=t(e).children().toArray();for(let e=0;e<r.length;++e)this.originalArray.push(r[e])}else if(("DIV"===e.tagName||"SPAN"===e.tagName)&&t(e).children().length>0&&("DIV"===e.children[0].tagName||"SPAN"===e.children[0].tagName)){let r=e.children[0],n=t(r).find("div");for(let e=0;e<n.length;++e){let r=t(n[e]).find("div"),a=t(r[0]).find("input")[0];this.originalArray.push(a)}}this.initEventHandler()}function y(e){let r=t(e),n="";if("value"===r.attr("name"))n=m.getElementValue(r);else if("DIV"===r.prop("tagName")||"SPAN"===r.prop("tagName")){let e=r.find('[name="value"]');if(e){let r=Array();e.each((function(){let e=m.getElementValue(t(this));e&&r.push(e)})),n=r.toString()}}else if("file"===r.attr("type")){let e=r.get(0).files;e&&e.length>0&&(n=e[0].name)}else"INPUT"!==r.prop("tagName")||["","name"].includes(r.attr("name"))||(n=m.getElementValue(r));return n}return g.prototype.getParameterName=function(){return this.paramName},g.prototype.getParameterElement=function(){return this.paramElement},g.prototype.getReferencedParameters=function(){return this.referencedParameters},g.prototype.getRandomName=function(){return this.randomName},g.prototype.getFilterElement=function(){return this.filterElement},g.prototype.setFilterElement=function(e){this.filterElement=e},g.prototype.getReferencedParametersAsText=function(){let e=[];for(let t=0;t<this.getReferencedParameters().length;t++){let r=this.getReferencedParameters()[t],n=r.getParameterName(),a=y(r.getParameterElement());e.push(`${n}=${a}`)}return e.join("__LESEP__")},g.prototype.update=c((function(e){const a=this;let i=a.getReferencedParametersAsText();return console.log(`Values retrieved from Referenced Parameters: ${i}`),s(new Promise((e=>a.proxy.doUpdate(i,(t=>e(t))))),(function(){let i=a;return console.log("Calling Java server code to update HTML elements..."),s(new Promise((e=>a.proxy.getChoicesForUI((r=>{let n=r.responseObject();console.log(`Values returned from server: ${n}`);let a=n[0],l=n[1],o=[],s=[];for(let e=0;e<a.length;e++){let t=String(a[e]);t&&(t.endsWith(":selected")||t.endsWith(":selected:disabled"))&&(o.push(e),a[e]=a[e].replace(/:selected$/,"").replace(/:selected:disabled$/,":disabled")),t&&(t.endsWith(":disabled")||t.endsWith(":disabled:selected"))&&(s.push(e),a[e]=a[e].replace(/:disabled$/,"").replace(/:disabled:selected$/,":selected"));let r=String(l[e]);r&&"string"==typeof r&&(r.endsWith(":selected")||r.endsWith(":selected:disabled"))&&(l[e]=l[e].replace(/:selected$/,"").replace(/:selected:disabled$/,":disabled")),r&&"string"==typeof r&&(r.endsWith(":disabled")||r.endsWith(":disabled:selected"))&&(l[e]=l[e].replace(/:disabled$/,"").replace(/:disabled:selected$/,":selected"))}i.getFilterElement()&&console.log("Updating values in filter array");let c=i.getParameterElement();if("SELECT"===c.tagName){for(;c.options.length>0;)c.remove(c.options.length-1);for(let e=0;e<a.length;e++){let t=document.createElement("option"),r=l[e],n=a[e];!n instanceof String?(t.text=JSON.stringify(n),t.value=JSON.stringify(r)):(t.text=n,t.value=r),o.indexOf(e)>=0&&t.setAttribute("selected","selected"),s.indexOf(e)>=0&&t.setAttribute("disabled","disabled"),c.add(t,null)}"multiple"===c.getAttribute("multiple")&&c.setAttribute("size",`${a.length>10?10:a.length}px`);let e=[];for(let t=0;t<i.getParameterElement().options.length;++t)e.push(i.getParameterElement().options[t]);i.getFilterElement()&&i.getFilterElement().setOriginalArray(e)}else if(("DIV"===c.tagName||"SPAN"===c.tagName)&&c.children.length>0&&("DIV"===c.children[0].tagName||"SPAN"===c.children[0].tagName)){let e=c.children[0];t(e).empty();let r=[];if("dynamic_checkbox"===c.className){for(let t=0;t<a.length;t++){let n=a[t],c=l[t],u=`ecp_${i.getRandomName()}_${t}`;u=u.replace(" ","_");let d=m.makeCheckbox(c,o.indexOf(t)>=0,s.indexOf(t)>=0);!n instanceof String?(d.setAttribute("title",JSON.stringify(n)),d.setAttribute("alt",JSON.stringify(n))):(d.setAttribute("title",n),d.setAttribute("alt",n));let f=m.makeLabel(!n instanceof String?JSON.stringify(n):n,void 0);r.push(d);let g=m.makeTd([d,f]),p=m.makeTr(u);p.appendChild(g),e.appendChild(p)}i.getFilterElement()&&i.getFilterElement().setOriginalArray(r)}else{for(let t=0;t<a.length;t++){let n=a[t],c=l[t],u=`ecp_${i.getRandomName()}_${t}`;u=u.replace(" ","_");let d=m.makeRadio(c,i.getParameterName(),o.indexOf(t)>=0,s.indexOf(t)>=0);d.setAttribute("onchange",`UnoChoice.fakeSelectRadioButton("${i.getParameterName()}", "${u}")`),d.setAttribute("otherId",u),!n instanceof String?d.setAttribute("alt",JSON.stringify(n)):d.setAttribute("alt",n);let f=m.makeLabel(!n instanceof String?JSON.stringify(n):n,void 0),g=m.makeHidden(u,c,o.indexOf(t)>=0?"value":"",c,i.getParameterName(),n instanceof String?n:JSON.stringify(n));r.push(d);let p=m.makeTd([d,f,g]),h=m.makeTr(void 0);h.appendChild(p),e.appendChild(h);let b=document.createElement("div");b.setAttribute("style","display: none"),b.setAttribute("class","radio-block-end"),e.appendChild(b)}i.getFilterElement()&&i.getFilterElement().setOriginalArray(r)}c.style.height=a.length>10?"230px":"auto"}e(r)})))),(function(){return n((function(){if(!e)return n((function(){if(f&&f.length>0)return o(l(f,(function(e){let t=f[e];return n((function(){if(a.referencesMe(t))return console.log(`Updating ${t.getParameterName()} from ${a.getParameterName()}`),r(t.update(!0))}))})))}));console.log("Avoiding infinite loop due to recursion!")}))}))}))})),g.prototype.referencesMe=function(e){if(!e||!e.getReferencedParameters()||0===e.getReferencedParameters().length)return!1;for(let t=0;t<e.getReferencedParameters().length;t++)if(e.getReferencedParameters()[t].getParameterName()===this.getParameterName())return!0;return!1},p.prototype.getParameterName=function(){return this.paramName},p.prototype.getParameterElement=function(){return this.paramElement},p.prototype.getCascadeParameter=function(){return this.cascadeParameter},h.prototype=new g,h.prototype.update=c((function(e){const a=this;let i=a.getReferencedParametersAsText();return console.log(`Values retrieved from Referenced Parameters: ${i}`),s(new Promise((e=>a.proxy.doUpdate(i,(t=>e(t))))),(function(){let i=a.getParameterElement();return s=function(){return n((function(){if(!e)return n((function(){if(f&&f.length>0)return o(l(f,(function(e){let t=f[e];return n((function(){if(a.referencesMe(t))return console.log(`Updating ${t.getParameterName()} from ${a.getParameterName()}`),r(t.update(!0))}))})))}));console.log("Avoiding infinite loop due to recursion!")}))},(c="OL"===i.tagName?(console.log("Calling Java server code to update HTML elements..."),r(new Promise((e=>a.proxy.getChoicesForUI((r=>{t(i).empty();let n=r.responseObject();console.log(`Values returned from server: ${n}`);let a=n[0];for(let e=0;e<a.length;++e){let t=document.createElement("li");t.innerHTML=a[e],i.appendChild(t)}e(r)})))))):n((function(){return"UL"===i.tagName?(t(i).empty(),console.log("Calling Java server code to update HTML elements..."),r(new Promise((e=>a.proxy.getChoicesForUI((t=>{let r=t.responseObject();console.log(`Values returned from server: ${r}`);let n=r[0];for(let e=0;e<n.length;++e){let t=document.createElement("li");t.innerHTML=n[e],i.appendChild(t)}e(t)})))))):n((function(){return i.id.indexOf("inputElement_")>-1?r(new Promise((e=>a.proxy.getChoicesAsStringForUI((t=>{i.value=t.responseObject(),e(t)}))))):n((function(){if(i.id.indexOf("formattedHtml_")>-1)return r(new Promise((e=>a.proxy.getChoicesAsStringForUI((t=>{i.innerHTML=t.responseObject(),e(t)})))))}))}))})))&&c.then?c.then(s):s();var s,c}))})),b.prototype.getParameterElement=function(){return this.paramElement},b.prototype.getFilterElement=function(){return this.filterElement},b.prototype.getOriginalArray=function(){return this.originalArray},b.prototype.getFilterLength=function(){return this.filterLength},b.prototype.setOriginalArray=function(e){this.originalArray=e,this.clearFilterElement()},b.prototype.clearFilterElement=function(){this.getFilterElement().value=""},b.prototype.initEventHandler=function(){let e=this;t(e.filterElement).keyup((r=>{let n=e.getFilterElement(),a=e.getParameterElement(),i=n.value.toLowerCase();if(0!==i.length&&i.length<e.getFilterLength())return;let l=e.originalArray,o=Array();for(let e=0;e<l.length;e++)void 0!==l[e]&&"INPUT"===l[e].tagName?l[e].getAttribute("alt")&&l[e].getAttribute("alt")!==l[e].value?l[e].getAttribute("alt").toLowerCase().match(i)&&o.push(l[e]):l[e].value.toLowerCase().match(i)&&o.push(l[e]):void 0!==l[e]&&l[e].innerHTML.toLowerCase().match(i)&&o.push(l[e]);let s=a.tagName;if("SELECT"===s){t(a).children().remove();for(let e=0;e<o.length;++e){let r=document.createElement("option");r.value=o[e].value,r.innerHTML=o[e].innerHTML,t(a).append(r)}}else if(("DIV"===s||"SPAN"===s)&&t(a).children().length>0&&("DIV"===t(a).children()[0].tagName||"SPAN"===t(a).children()[0].tagName)){let e=a.children[0];if(t(e).empty(),"dynamic_checkbox"===a.className)for(let t=0;t<o.length;t++){let n=o[t],a=`ecp_${r.target.randomName}_${t}`;a=a.replace(" ","_");let i=n instanceof String?m.makeCheckbox(n,void 0,void 0):"INPUT"===n.tagName?n:m.makeRadio(JSON.stringify(n.value),"value",void 0,void 0),l=n instanceof String||"INPUT"===n.tagName?m.makeLabel(n.getAttribute("title"),n.getAttribute("title")):m.makeLabel(i,void 0),s=m.makeTd([i,l]),c=m.makeTr(a);c.appendChild(s),e.appendChild(c)}else for(let t=0;t<o.length;t++){let r=o[t],n="";r instanceof String?n=`ecp_${r}_${t}`:"INPUT"===r.tagName&&(n=`ecp_${r.getAttribute("name")}_${t}`),n=n.replace(" ","_");let a=document.createElement("input");a=r,a.checked=!1;let i=m.makeHidden(a.getAttribute("otherid"),a.getAttribute("json"),"",a.getAttribute("value"),a.getAttribute("name"),a.getAttribute("alt")),l=m.makeLabel(a.getAttribute("alt"),void 0),s=m.makeTd([a,l,i]),c=m.makeTr(n);c.appendChild(s),e.appendChild(c)}}console.log("Propagating change event after filtering");let c=t.Event("change",{parameterName:"Filter Element Event"});t(a).trigger(c)}))},d.fakeSelectRadioButton=function(e,r){let n=t(`#${r}`).get(0);t(`input[class="${e}"]`).each((function(e){t(this).attr("name","")}));let a=n.parentNode.childNodes;for(let t=0;t<a.length;t++){let r=a[t];r.className===e&&(r.name="value")}},d.getParameterValue=y,d.CascadeParameter=g,d.DynamicReferenceParameter=h,d.ReferencedParameter=p,d.FilterElement=b,d.cascadeParameters=f,d.renderChoiceParameter=function(e,r){let n=t(`#${e}`),a=n.find("DIV");if(a&&0!==a.length||(console.log("Could not find element by name, perhaps it is a DIV?"),a=n.find('*[name="value"]')),a&&a.get(0)){let e=n.find(".uno_choice_filter");e&&e.get(0)?a.filterElement=new u.FilterElement(a.get(0),e.get(0),r):console.log("Filter error: Missing filter element!")}else console.log("Filter error: Missing parameter element!")},d.renderCascadeChoiceParameter=i,d.renderDynamicRenderParameter=a,d})(jQuery3);window.UnoChoice=u}();
//# sourceMappingURL=UnoChoice.js.map